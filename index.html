<HTML>

<meta name="viewport" content="width=device-width, 
    initial-scale=1, maximum-scale=1, user-scalable=0"/>

<style>
canvas {
	display:block;
	background:#004058;
	user-select:none;
	
}
*{
	margin: 0;
   	padding: 0;
}
</style>

<CANVAS id='gamewindow'></<CANVAS>


<SCRIPT>

var canvas = document.getElementById('gamewindow');
var ctx = canvas.getContext('2d')

canvas.width = window.innerWidth //360;
canvas.height = window.innerHeight //640;

function randomINT(num){
	return Math.floor(Math.random()*(num+1))
}
function cycleArray(array){
	array.push(array.shift())
}
class Stars{
  constructor(count,size,speed,width,height,vertical = true){
	this.stars = [];
	this.size = size;
	this.speed = speed;
	this.maxSpeed = speed;
	this.vertical = vertical;
	this.width = width;
	this.height = height;
	this.time = 0;
	for(let i = 0; i < count; i++){
		this.stars.push([randomINT(width-this.size),randomINT(height-this.size)])
	}
  }
  update(){
	this.drawAndMoveStars();
	this.checkSpeed();
  }
  drawAndMoveStars(){
	var position,bounds,w = this.size,h = this.size;
	var warp = Math.max(0,this.speed-10) * 4;
	
	if (this.vertical){
		position = 1; h += warp; bounds = this.height;
	}else{
		position = 0; w += warp; bounds = this.width;
	}
	this.stars.forEach(star =>{
		ctx.fillRect(star[0],star[1],w,h)
		star[position] += this.speed
		if(star[position] > bounds) star[position] -= bounds + this.size + warp ;
		else if (star[position] < -this.size) star[position] += bounds + this.size + warp;
	})
  }
	checkSpeed(){
		if(this.speed < this.maxSpeed){
			this.speed = Math.min(this.speed + .5, this.maxSpeed)
		}else if (this.speed > this.maxSpeed){
			this.speed = Math.max(this.speed - .5, this.maxSpeed)
		}
	}
}

class GameControl{
	constructor(){
		this.time = 0;
		this.starColor = ['#00e8d8','#a4effc','white','#d8f878'];
		this.starfields = [
			new Stars(12,6,3,canvas.width,canvas.height),
			new Stars(12,3,1,canvas.width,canvas.height)
		]
	}
	draw(){
		if (this.time == 15){
			this.time = 0
			cycleArray(this.starColor)
		}
		this.time++
		ctx.fillStyle = this.starColor[0];
		this.starfields[0].update();
		this.starfields[1].update();
	}
}

function loop(){
	requestAnimationFrame(loop);
	ctx.clearRect(0,0,canvas.width,canvas.height)
	GAME.draw();
}
window.addEventListener('touchstart',()=>{
	GAME.starfields[0].maxSpeed = 40;
	GAME.starfields[1].maxSpeed = 30;
})
window.addEventListener('touchend', ()=>{
	GAME.starfields[0].maxSpeed = 3;
	GAME.starfields[1].maxSpeed = 1;
})
var GAME = new GameControl();
loop();



</SCRIPT>
</HTML>
